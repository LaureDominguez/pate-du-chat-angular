<div class="admin-section">
    <h2>Liste des catégories</h2>
    
    <table mat-table [dataSource]="categories" matSort #categoriesSort="matSort">
        <!-- Nom Column -->
        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Nom</th>
            <td mat-cell *matCellDef="let category">
                <!-- Mode normal -->
                <span *ngIf="!editingCategory || editingCategory._id !== category._id">
                    {{ category.name }}
                </span>
                <!-- Mode édition -->
                <mat-form-field *ngIf="editingCategory && editingCategory._id === category._id" appearance="fill">
                    <input 
                        #categoryInput
                        matInput 
                        [(ngModel)]="category.name" 
                        placeholder="Nom de la catégorie" 
                        (keydown.enter)="saveCategory(category)"
                        (blur)="cancelEdit($event)"
                    />
                </mat-form-field>
            </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>Actions</th>
            <td mat-cell *matCellDef="let category">

                <!-- Edit -->
                <button mat-button class="animated-button edit" *ngIf="!editingCategory || editingCategory._id !== category._id" (click)="startEditing(category)">
                    <div class="content">
                        <mat-icon class="icon">edit</mat-icon>
                        <span class="text">Modifier</span>
                    </div>
                </button>

                <!-- Save -->
                <button mat-button class="animated-button save" *ngIf="editingCategory && editingCategory._id === category._id" (click)="saveCategory(category)">
                    <div class="content">
                        <mat-icon class="icon">check</mat-icon>
                        <span class="text">Enregistrer</span>
                    </div>
                </button>

                <!-- Delete -->
                <button mat-button class="animated-button delete" *ngIf="!editingCategory || editingCategory._id !== category._id" (click)="deleteCategory(category)">
                    <div class="content">
                        <mat-icon class="icon">delete</mat-icon>
                        <span class="text">Supprimer</span>
                    </div>
                </button>

                <!-- Cancel -->
                <button mat-button class="animated-button cancel" *ngIf="editingCategory && editingCategory._id === category._id" (click)="cancelEdit()">
                    <div class="content">
                        <mat-icon class="icon">close</mat-icon>
                        <span class="text">Annuler</span>
                    </div>
                </button>
            </td>
        </ng-container>

        <!-- Header and Row Declarations -->
        <tr mat-header-row *matHeaderRowDef="displayedCategoriesColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedCategoriesColumns;"></tr>
    </table>

    <mat-divider></mat-divider>

    <div class="add-button">
        <button mat-button class="add" (click)="startEditing()">Ajouter une catégorie</button>
        <mat-paginator #categoriesPaginator [pageSize]="10"></mat-paginator>
    </div>
</div>